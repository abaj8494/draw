<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Draw</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div id="app">
        <!-- Background Canvas -->
        <canvas id="background-canvas"></canvas>
        <!-- Drawing Canvas -->
        <canvas id="drawing-canvas"></canvas>

        <!-- Mobile Toggle Button -->
        <button id="mobile-toggle" class="mobile-only">
            <svg viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
        </button>

        <!-- Toolbar -->
        <div id="toolbar" class="toolbar">
            <div class="toolbar-header">
                <span class="toolbar-title">Tools</span>
                <div class="toolbar-header-buttons">
                    <button id="toolbar-minimize" title="Minimize">&minus;</button>
                    <button id="toolbar-close" class="mobile-only">&times;</button>
                </div>
            </div>

            <div class="toolbar-section">
                <div class="tool-group">
                    <button class="tool-btn active" data-tool="pencil" title="Pencil">
                        <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                    </button>
                    <button class="tool-btn" data-tool="pen" title="Pen (Smooth)">
                        <svg viewBox="0 0 24 24"><path d="M20.71 4.04c-.39-.39-1.02-.39-1.41 0L6 17.34V20h2.66L22 6.66c.39-.39.39-1.02 0-1.41l-1.29-1.21zM8 19H7v-1l10-10 1 1L8 19z" fill="currentColor"/><path d="M3 17v4h4l.5-.5L3.5 17H3z" fill="currentColor"/></svg>
                    </button>
                    <button class="tool-btn" data-tool="highlighter" title="Highlighter">
                        <svg viewBox="0 0 24 24"><path d="M6 14l3 3v5h6v-5l3-3V9H6v5zm5-12h2v3h-2V2zM3.5 5.88l1.41-1.41 2.12 2.12L5.62 8 3.5 5.88zm13.46.71l2.12-2.12 1.41 1.41L18.38 8l-1.42-1.41z"/></svg>
                    </button>
                </div>

                <div class="tool-group expandable-group">
                    <button class="tool-btn" data-tool="shape" data-expandable="shape" title="Shapes">
                        <svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" fill="none" stroke="currentColor" stroke-width="2"/></svg>
                    </button>
                    <div class="tool-submenu hidden" data-submenu="shape">
                        <button class="tool-btn subtool" data-tool="shape-line" title="Line">
                            <svg viewBox="0 0 24 24"><line x1="4" y1="20" x2="20" y2="4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                        </button>
                        <button class="tool-btn subtool" data-tool="shape-rect" title="Rectangle">
                            <svg viewBox="0 0 24 24"><rect x="3" y="5" width="18" height="14" fill="none" stroke="currentColor" stroke-width="2"/></svg>
                        </button>
                        <button class="tool-btn subtool" data-tool="shape-circle" title="Circle">
                            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"/></svg>
                        </button>
                        <button class="tool-btn subtool" data-tool="shape-triangle" title="Triangle">
                            <svg viewBox="0 0 24 24"><path d="M12 4L3 20h18z" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>
                        </button>
                    </div>
                </div>

                <div class="tool-group expandable-group">
                    <button class="tool-btn" data-tool="eraser" data-expandable="eraser" title="Eraser">
                        <svg viewBox="0 0 24 24"><path d="M16.24 3.56l4.95 4.94c.78.79.78 2.05 0 2.84L12 20.53a4.008 4.008 0 0 1-5.66 0L2.81 17c-.78-.79-.78-2.05 0-2.84l10.6-10.6c.79-.78 2.05-.78 2.83 0zm-1.41 1.42L6.93 12.88l4.24 4.24 7.9-7.9-4.24-4.24zM4 21h16v2H4v-2z"/></svg>
                    </button>
                    <div class="tool-submenu hidden" data-submenu="eraser">
                        <button class="tool-btn subtool" data-tool="eraser-pixel" title="Pixel Eraser">
                            <svg viewBox="0 0 24 24"><path d="M16.24 3.56l4.95 4.94c.78.79.78 2.05 0 2.84L12 20.53a4.008 4.008 0 0 1-5.66 0L2.81 17c-.78-.79-.78-2.05 0-2.84l10.6-10.6c.79-.78 2.05-.78 2.83 0zm-1.41 1.42L6.93 12.88l4.24 4.24 7.9-7.9-4.24-4.24zM4 21h16v2H4v-2z"/></svg>
                        </button>
                        <button class="tool-btn subtool" data-tool="eraser-object" title="Object Eraser">
                            <svg viewBox="0 0 24 24"><path d="M15 16h4v2h-4v-2zm0-8h7v2h-7V8zm0 4h6v2h-6v-2zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3v10zM14 5h-3l-1-1H6L5 5H2v2h12V5z"/></svg>
                        </button>
                    </div>
                </div>

                <div class="tool-group">
                    <button class="tool-btn" data-tool="lasso" title="Lasso Select">
                        <svg viewBox="0 0 24 24"><path d="M12 2C7.03 2 3 6.03 3 11c0 2.1.72 4.03 1.93 5.57L3 21l4.43-1.93C9 20.28 10.43 21 12 21c4.97 0 9-4.03 9-9s-4.03-10-9-10z" fill="none" stroke="currentColor" stroke-width="2" stroke-dasharray="4 2"/><circle cx="12" cy="21" r="2" fill="currentColor"/></svg>
                    </button>
                    <button class="tool-btn" data-tool="marquee" title="Marquee Select">
                        <svg viewBox="0 0 24 24"><path d="M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2z"/></svg>
                    </button>
                </div>

                <div class="tool-group">
                    <button class="tool-btn" data-tool="pan" title="Pan">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10.5 1.875a1.125 1.125 0 0 1 2.25 0v8.219c.517.162 1.02.382 1.5.659V3.375a1.125 1.125 0 0 1 2.25 0v10.937a4.505 4.505 0 0 0-3.25 2.373 8.963 8.963 0 0 1 4-.935A.75.75 0 0 0 18 15v-2.266a3.368 3.368 0 0 1 .988-2.37 1.125 1.125 0 0 1 1.591 1.59 1.118 1.118 0 0 0-.329.79v3.006h-.005a6 6 0 0 1-1.752 4.007l-1.736 1.736a6 6 0 0 1-4.242 1.757H10.5a7.5 7.5 0 0 1-7.5-7.5V6.375a1.125 1.125 0 0 1 2.25 0v5.519c.46-.452.965-.832 1.5-1.141V3.375a1.125 1.125 0 0 1 2.25 0v6.526c.495-.1.997-.151 1.5-.151V1.875Z"/></svg>
                    </button>
                    <button class="tool-btn" data-tool="move" title="Move Selection">
                        <svg viewBox="0 0 24 24"><path d="M13 6v5h5V7.75L22.25 12 18 16.25V13h-5v5h3.25L12 22.25 7.75 18H11v-5H6v3.25L1.75 12 6 7.75V11h5V6H7.75L12 1.75 16.25 6H13z"/></svg>
                    </button>
                </div>

                <div class="tool-group expandable-group">
                    <button class="tool-btn" data-tool="laser" data-expandable="laser" title="Laser Pointer">
                        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 2v4m0 12v4M2 12h4m12 0h4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/></svg>
                    </button>
                    <div class="tool-submenu hidden" data-submenu="laser">
                        <button class="tool-btn subtool" data-tool="laser-plain" title="Laser (No Trail)">
                            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/></svg>
                        </button>
                        <button class="tool-btn subtool" data-tool="laser-trail" title="Laser (With Trail)">
                            <svg viewBox="0 0 24 24"><circle cx="18" cy="6" r="3" fill="currentColor"/><path d="M18 9c0 2-2 3-4 5s-4 3-4 5c0 1.5-1 3-3 3" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                        </button>
                    </div>
                </div>
            </div>

            <div class="toolbar-section">
                <label class="toolbar-label">Shape Snap</label>
                <div class="toggle-row">
                    <input type="checkbox" id="shape-snap" />
                    <label for="shape-snap">Snap to shapes</label>
                </div>
            </div>

            <div class="toolbar-section">
                <label class="toolbar-label">Size</label>
                <input type="range" id="brush-size" min="1" max="50" value="3">
                <span id="brush-size-value">3</span>
            </div>

            <div class="toolbar-section">
                <label class="toolbar-label">Color</label>
                <input type="color" id="brush-color" value="#000000">
                <div class="color-presets">
                    <button class="color-preset" data-color="#000000" style="background:#000000"></button>
                    <button class="color-preset" data-color="#ff0000" style="background:#ff0000"></button>
                    <button class="color-preset" data-color="#00ff00" style="background:#00ff00"></button>
                    <button class="color-preset" data-color="#0000ff" style="background:#0000ff"></button>
                    <button class="color-preset" data-color="#ffff00" style="background:#ffff00"></button>
                    <button class="color-preset" data-color="#ff00ff" style="background:#ff00ff"></button>
                </div>
            </div>

            <div class="toolbar-section">
                <label class="toolbar-label">Background</label>
                <div class="background-options">
                    <button class="bg-option active" data-bg="grid-light" title="Grid Light">
                        <div class="bg-preview grid-light"></div>
                    </button>
                    <button class="bg-option" data-bg="grid-dark" title="Grid Dark">
                        <div class="bg-preview grid-dark"></div>
                    </button>
                    <button class="bg-option" data-bg="grid-sepia" title="Grid Sepia">
                        <div class="bg-preview grid-sepia"></div>
                    </button>
                    <button class="bg-option" data-bg="blank-light" title="Blank Light">
                        <div class="bg-preview blank-light"></div>
                    </button>
                    <button class="bg-option" data-bg="blank-dark" title="Blank Dark">
                        <div class="bg-preview blank-dark"></div>
                    </button>
                    <button class="bg-option" data-bg="blank-sepia" title="Blank Sepia">
                        <div class="bg-preview blank-sepia"></div>
                    </button>
                </div>
            </div>

            <div class="toolbar-section">
                <label class="toolbar-label">Actions</label>
                <div class="action-buttons">
                    <button id="undo-btn" class="action-btn" title="Undo (Ctrl+Z)">
                        <svg viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"/></svg>
                    </button>
                    <button id="redo-btn" class="action-btn" title="Redo (Ctrl+Y)">
                        <svg viewBox="0 0 24 24"><path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"/></svg>
                    </button>
                    <button id="clear-btn" class="action-btn" title="Clear Canvas">
                        <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                    </button>
                </div>
            </div>

            <div class="toolbar-section">
                <label class="toolbar-label">Export</label>
                <div class="export-buttons">
                    <button id="export-png" class="export-btn">PNG</button>
                    <button id="export-svg" class="export-btn">SVG</button>
                    <button id="export-pdf" class="export-btn">PDF</button>
                </div>
            </div>

            <div class="toolbar-section">
                <label class="toolbar-label">Saves</label>
                <div class="save-buttons">
                    <button id="save-btn" class="save-btn">Save</button>
                    <button id="load-btn" class="save-btn">Load</button>
                </div>
            </div>
        </div>

        <!-- File Browser Modal -->
        <div id="file-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <span class="modal-title">Saved Drawings</span>
                    <button id="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="save-form" class="hidden">
                        <input type="text" id="save-name" placeholder="Drawing name...">
                        <button id="save-confirm">Save</button>
                    </div>
                    <div id="file-list"></div>
                </div>
            </div>
        </div>

        <!-- Laser pointer overlay -->
        <div id="laser-pointer" class="hidden"></div>
    </div>

    <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Application Scripts -->
    <script src="js/storage.js"></script>
    <script src="js/canvas.js"></script>
    <script src="js/tools.js"></script>
    <script src="js/export.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
